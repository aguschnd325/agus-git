{
    "Snippet: PageWizard": {
        "description": "Snippet (CRS): Wizard Page (3 steps)",
        "prefix": "tpagewizard (CRS: 3 steps)",
        "body": [
            "page ${1:Id} \"${2:PageName} Wizard\"",
            "{",
            "\tCaption='${2:PageName}';",
            "\tPageType = NavigatePage;",
            "\tSourceTable = ${3:\"TableName\"};",
            "\tSourceTableTemporary=true;",
            "",
            "\tlayout",
            "\t{",
            "\t\tarea(content)",
            "\t\t{",
            "\t\t\tgroup(StandardBanner)",
            "\t\t\t{",
            "\t\t\t\tCaption='';",
            "\t\t\t\tEditable=false;",
            "\t\t\t\tVisible=TopBannerVisible AND NOT FinishActionEnabled;",
            "\t\t\t\tfield(MediaResourcesStandard;MediaResourcesStandard.\"Media Reference\")",
            "\t\t\t\t{",
            "\t\t\t\t  ApplicationArea = All;",
            "\t\t\t\t  Editable=false;",
            "\t\t\t\t  ShowCaption=false;",
            "\t\t\t\t}",
            "\t\t\t}",
            "\t\t\tgroup(FinishedBanner)",
            "\t\t\t{",
            "\t\t\t\tCaption='';",
            "\t\t\t\tEditable=false;",
            "\t\t\t\tVisible=TopBannerVisible AND FinishActionEnabled;",
            "\t\t\t\tfield(MediaResourcesDone;MediaResourcesDone.\"Media Reference\")",
            "\t\t\t\t{",
            "\t\t\t\t  ApplicationArea = All;",
            "\t\t\t\t  Editable=false;",
            "\t\t\t\t  ShowCaption=false;",
            "\t\t\t\t}",
            "\t\t\t}",
            "",
            "\t\t\tgroup(Step1)",
            "\t\t\t{",
            "\t\t\t\tVisible=Step1Visible;",
            "\t\t\t\tgroup(\"Welcome to ${2:PageName}\")",
            "\t\t\t\t{",
            "\t\t\t\t\tCaption='Welcome to ${2:PageName} Setup';",
            "\t\t\t\t\tVisible=Step1Visible;",
            "\t\t\t\t\tgroup(Group18)",
            "\t\t\t\t\t{",
            "\t\t\t\t\t\tCaption='';",
            "\t\t\t\t\t\tInstructionalText='Step1 - Replace this text with some instructions.';",
            "\t\t\t\t\t}",
            "\t\t\t\t}",
            "\t\t\t\tgroup(\"Let's go!\")",
            "\t\t\t\t{",
            "\t\t\t\t\tCaption='Let''s go!';",
            "\t\t\t\t\tgroup(Group22)",
            "\t\t\t\t\t{",
            "\t\t\t\t\t\tCaption='';",
            "\t\t\t\t\t\tInstructionalText='Step1 - Replace this text with some more instructions.';",
            "\t\t\t\t\t}",
            "\t\t\t\t}",
            "\t\t\t}",
            "",
            "\t\t\tgroup(Step2)",
            "\t\t\t{",
            "\t\t\t\tCaption='';",
            "\t\t\t\tInstructionalText='Step2 - Replace this text with some instructions.';",
            "\t\t\t\tVisible=Step2Visible;",
            "\t\t\t\t//You might want to add fields here",
            "\t\t\t}",
            "\t\t\t",
            "",
            "\t\t\tgroup(Step3)",
            "\t\t\t{",
            "\t\t\t\tVisible=Step3Visible;",
            "\t\t\t\tgroup(Group23)",
            "\t\t\t\t{",
            "\t\t\t\t\tCaption='';",
            "\t\t\t\t\tInstructionalText='Step3 - Replace this text with some instructions.';",
            "\t\t\t\t}",
            "\t\t\t\tgroup(\"That's it!\")",
            "\t\t\t\t{",
            "\t\t\t\t\tCaption='That''s it!';",
            "\t\t\t\t\tgroup(Group25)",
            "\t\t\t\t\t{",
            "\t\t\t\t\t\tCaption='';",
            "\t\t\t\t\t\tInstructionalText='To save this setup, choose Finish.';",
            "\t\t\t\t\t}",
            "\t\t\t\t}",
            "\t\t\t}",
            "\t\t}",
            "\t}",
            "actions",
            "{",
            "\tarea(processing)",
            "\t{",
            "\t\taction(ActionBack)",
            "\t\t{",
            "\t\t\tApplicationArea = All;",
            "\t\t\tCaption='Back';",
            "\t\t\tEnabled=BackActionEnabled;",
            "\t\t\tImage=PreviousRecord;",
            "\t\t\tInFooterBar=true;",
            "\t\t\ttrigger OnAction();",
            "\t\t\tbegin",
            "\t\t\t\tNextStep(TRUE);",
            "\t\t\tend;",
            "\t\t}",
            "\t\taction(ActionNext)",
            "\t\t{",
            "\t\t\tApplicationArea = All;",
            "\t\t\tCaption='Next';",
            "\t\t\tEnabled=NextActionEnabled;",
            "\t\t\tImage=NextRecord;",
            "\t\t\tInFooterBar=true;",
            "\t\t\ttrigger OnAction();",
            "\t\t\tbegin",
            "\t\t\t\tNextStep(FALSE);",
            "\t\t\tend;",
            "\t\t}      ",
            "\t\taction(ActionFinish)",
            "\t\t{",
            "\t\t\tApplicationArea = All;",
            "\t\t\tCaption='Finish';",
            "\t\t\tEnabled=FinishActionEnabled;",
            "\t\t\tImage=Approve;",
            "\t\t\tInFooterBar=true;",
            "\t\t\ttrigger OnAction();",
            "\t\t\tbegin",
            "\t\t\t\tFinishAction;",
            "\t\t\tend;",
            "\t\t}",
            "\t}",
            "}",
            "trigger OnInit();",
            "begin",
            "  LoadTopBanners;",
            "end;",
            "trigger OnOpenPage();",
            "var",
            "\t${4:RecordVar} : Record ${3:TableName};",
            "begin",
            "\tINIT;",
            "\tIF ${4:RecordVar}.GET THEN BEGIN",
            "\t  TRANSFERFIELDS(${4:RecordVar});",
            "\tEND;",
            "\tINSERT;",
            "",
            "\tStep := Step::Start;",
            "\tEnableControls;",
            "end;",
            "var",
            "\tMediaRepositoryStandard : Record \"Media Repository\";",
            "\tMediaRepositoryDone : Record \"Media Repository\";",
            "\tMediaResourcesStandard : Record \"Media Resources\";",
            "\tMediaResourcesDone : Record \"Media Resources\";",
            "\tStep : Option Start,Step2,Finish;",
            "\tTopBannerVisible : Boolean;",
            "\tStep1Visible : Boolean;",
            "\tStep2Visible : Boolean;",
            "\tStep3Visible : Boolean;",
            "\tFinishActionEnabled : Boolean;",
            "\tBackActionEnabled : Boolean;",
            "\tNextActionEnabled : Boolean;",
            "local procedure EnableControls();",
            "begin",
            "  ResetControls;",
            "",
            "  CASE Step OF",
            "    Step::Start:",
            "      ShowStep1;",
            "    Step::Step2:",
            "      ShowStep2;",
            "    Step::Finish:",
            "      ShowStep3;",
            "  END;",
            "end;",
            "",
            "local procedure Store${4:RecordVar}();",
            "var",
            "\t${4:RecordVar} : Record ${3:TableName};",
            "begin",
            "\tIF NOT ${4:RecordVar}.GET THEN BEGIN",
            "\t\t${4:RecordVar}.INIT;",
            "\t\t${4:RecordVar}.INSERT;",
            "\tEND;",
            "",
            "\t${4:RecordVar}.TRANSFERFIELDS(Rec,FALSE);",
            "\t${4:RecordVar}.MODIFY(TRUE);",
            "\tCOMMIT;",
            "end;",
            "",
            "",
            "local procedure FinishAction();",
            "begin",
            "  Store${4:RecordVar};",
            "  CurrPage.CLOSE;",
            "end;",
            "",
            "local procedure NextStep(Backwards : Boolean);",
            "begin",
            "  IF Backwards THEN",
            "    Step := Step - 1",
            "  ELSE",
            "    Step := Step + 1;",
            "",
            "  EnableControls;",
            "end;",
            "",
            "local procedure ShowStep1();",
            "begin",
            "  Step1Visible := TRUE;",
            "",
            "  FinishActionEnabled := FALSE;",
            "  BackActionEnabled := FALSE;",
            "end;",
            "",
            "local procedure ShowStep2();",
            "begin",
            "  Step2Visible := TRUE;",
            "end;",
            "",
            "local procedure ShowStep3();",
            "begin",
            "  Step3Visible := TRUE;",
            "",
            "  NextActionEnabled := FALSE;",
            "  FinishActionEnabled := TRUE;",
            "end;",
            "",
            "local procedure ResetControls();",
            "begin",
            "  FinishActionEnabled := FALSE;",
            "  BackActionEnabled := TRUE;",
            "  NextActionEnabled := TRUE;",
            "",
            "  Step1Visible := FALSE;",
            "  Step2Visible := FALSE;",
            "  Step3Visible := FALSE;",
            "end;",
            "",
            "local procedure LoadTopBanners();",
            "begin",
            "  IF MediaRepositoryStandard.GET('AssistedSetup-NoText-400px.png',FORMAT(CURRENTCLIENTTYPE)) AND",
            "     MediaRepositoryDone.GET('AssistedSetupDone-NoText-400px.png',FORMAT(CURRENTCLIENTTYPE))",
            "  THEN",
            "    IF MediaResourcesStandard.GET(MediaRepositoryStandard.\"Media Resources Ref\") AND",
            "       MediaResourcesDone.GET(MediaRepositoryDone.\"Media Resources Ref\")",
            "    THEN",
            "      TopBannerVisible := MediaResourcesDone.\"Media Reference\".HASVALUE;",
            "end;",
            "}"
        ]
    }
}